def fib
  check_size 4 ;input
  branch eq 4 #0 1 _fib_ret_1
  branch neq 4 #0 1 _fib_rec
  check_size 4 ;output

def _fib_ret_1
  copy 4 1 #0

def _fib_rec
  extend 4
  add 8 #0 -1 #4
  call 4 fib

  extend 4
  add 8 #0 -2 #8
  call 8 fib

  add 8 #4 #8 #0
  shrink 8
