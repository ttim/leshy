def main
  ; create `fib length` version which passes length as constant
  append 10
  call 0 'fib'
  print_int 4 #0

def fib
  check_size 4 ;input
  branch 'le' 4 #0 1 '_fib_ret_1'
  branch 'm' 4 #0 1 '_fib_rec'
  check_size 4 ;output

def _fib_ret_1
  copy 4 1 #0

def _fib_rec
  extend 4
  add 4 #0 -1 #4
  call 4 'fib'

  extend 4
  add 4 #0 -2 #8
  call 8 'fib'

  add 4 #4 #8 #0
  shrink 8
